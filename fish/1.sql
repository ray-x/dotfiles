select count(*) over() as total, c.check_id, r.result_id, t.session_key, t.user_id_hash, coalesce(a.status, 'APPROVED') status, r.risk_level, t.activity_type, t.payment_type, t.device_id, coalesce(a.assigned_to, '') assigned_to, t.payment_id, r.type, r.sub_type, r.source, r.source_link, t.amount_value, t.amount_currency, t.transaction_timestamp, r.created_date, r.last_updated from kyt.results r left join kyt.alerts a on r.result_id = a.result_id join kyt.transactions t on r.transaction_id = t.transaction_id join kyt.checks c on r.check_id = c.check_id WHERE t.customer_id = '' AND t.entity_id = '' AND t.customer_child_id IS NULL ORDER BY r.created_date DESC LIMIT 20 OFFSET 0;

